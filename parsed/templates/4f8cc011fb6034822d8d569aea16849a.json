{"layout/empty":"<!DOCTYPE html>\n<html>\n<head>\n    <title>{{ head.title }}</title>\n    {{{ head.meta_tags }}}\n    {{{ head.config }}}\n    <link rel=\"stylesheet\" href=\"https://use.typekit.net/woi1sri.css\">\n    <link href=\"{{ head.favicon }}\" rel=\"shortcut icon\">\n    {{#block \"head\"}}{{/block}}\n</head>\n<body>\n    {{#block \"page\"}}{{/block}}\n</body>\n</html>\n","pages/checkout":"{{#partial \"head\"}} \n\n{{{ checkout.checkout_head }}}\n{{{ stylesheet '/assets/css/optimized-checkout.css' }}}\n{{ getFontsCollection }}\n<style>\n    label[for=\"radio-cheque\"] {\n        display: none !important;\n    }\n</style>\n<script type=\"text/javascript\">\n    window.language = {{{langJson 'optimized_checkout'}}};\n</script>\n\n{{{head.scripts}}}\n\n{{/partial}}\n\n{{#partial \"page\"}}\n<header class=\"checkoutHeader optimizedCheckout-header\">\n    <div class=\"checkoutHeader-content\">\n        <h1 class=\"is-srOnly\">{{lang 'checkout.title'}}</h1>\n        <h2 class=\"checkoutHeader-heading\">\n            <a class=\"checkoutHeader-link\" href=\"{{urls.home}}\">\n                {{#if checkout.header_image}}\n                    <img alt=\"{{settings.store_logo.title}}\" class=\"checkoutHeader-logo\" id=\"logoImage\" src=\"{{ checkout.header_image }}\"/>\n                {{ else }}\n                    <span class=\"header-logo-text\">{{settings.store_logo.title}}</span>\n                {{/if}}\n            </a>\n        </h2>\n    </div>\n</header>\n\n{{{ checkout.checkout_content }}}\n\n{{{ footer.scripts }}}\n<script src=\"https://code.jquery.com/jquery-3.3.1.min.js\"></script>\n<script>\n\njQuery(document).ready(function() {\n    $( \"#sameAsBilling\" ).prop( \"checked\", false );\n var ship = getCookie(\"appointment_details\");\n var cookieShipAddress = getCookie(\"ship_address\");\n\n console.log(ship);\n console.log(cookieShipAddress);\n \n    if (ship || (cookieShipAddress != '' && cookieShipAddress != '1')){\n        console.log(cookieShipAddress);\n        if (ship) {\n            var obj = JSON.parse(ship);\n            var ismobile = obj[0].ismobile;\n            console.log('Installer Shipping');\n            console.log(ismobile);\n            \n            //var ship = Cookies.get('ship_address');\n            var fullAddress = obj[0].address;\n            var installerName = obj[0].installer_name;\n\n            var address = fullAddress.split(',');\n            console.log(address);\n            var name = installerName.split(' ');\n            if (name.length == 3) {\n                var firstName = name[0] + ' ' + name[1];\n                var lastName = name[2];\n            } else if (name.length == 4) {\n                var firstName = name[0] + ' ' + name[1];\n                var lastName = name[2] + ' ' + name[3];\n            } else {\n                var firstName = name[0];\n                var lastName = name[1];\n            } \n\n            if(address.length == 5){\n                var state = $.trim(address[3]);\n                var city = address[2];\n                var address2 = address[1];\n                var postalCode = address[4];\n            }\n            else{\n                var state = $.trim(address[2]);\n                var city = address[1];\n                var address2 = '';\n                var postalCode = address[3];\n            }\n            \n            console.log(address); \n            //console.log(name);\n            //console.log(name.length);\n            //Fetch cart details\n            if(ismobile == 'no'){\n            fetch('/api/storefront/cart', {\n                credentials: 'include'\n            }).then(function(response) {\n                return response.json();\n            }).then(function(myJson) {\n                //console.log('Installer consignment');\n                var a = JSON.parse(JSON.stringify(myJson));\n                var x = [];\n\n                //push cart items to array x\n                for (var i = 0; i < a[0]['lineItems']['physicalItems'].length; i++) {\n                    x.push({\n                        \"itemId\": a[0]['lineItems']['physicalItems'][i]['id'],\n                        \"quantity\": a[0]['lineItems']['physicalItems'][i]['quantity']\n                    });\n                }\n\n        \n            createConsignment(`/api/storefront/checkouts/`, a[0]['id'],\n                    [{\n                        \"shippingAddress\": {\n                            \"first_name\": firstName,\n                            \"last_name\": lastName,\n                            \"address1\": address[0],\n                            \"address2\": address2,\n                            \"city\": city,\n                            \"stateOrProvinceCode\": state,\n                            \"countryCode\": 'US',\n                            \"postalCode\": postalCode,\n                            \"company\": installerName,\n                        },\n                        \"lineItems\": x\n                    }]\n                ).then(function(data) {\n                    //console.log(JSON.stringify(data));\n                    setCookie('cartId', data.cart.id);\n                    setCookie('consignmentsId', data.consignments[0].id);\n                    setCookie('shippingId', data.consignments[0].availableShippingOptions[0].id);\n\n                })\n                .catch(error => console.error(error));\n        });\n        $( \"#checkoutShippingAddress #firstNameInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #lastNameInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #companyInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #addressLine1Input\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #addressLine2Input\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #cityInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #countryCodeInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #provinceCodeInput\" ).prop( \"disabled\", true );\n            $( \"#checkoutShippingAddress #postCodeInput\" ).prop( \"disabled\", true );\n            \n           //$( \"#sameAsBilling\" ).prop( \"checked\", false );\n           //$( \"#sameAsBilling\" ).val(\"false\");\n                //$(\"#sameAsBilling\").removeAttr('checked');\n            $(\"label[for='sameAsBilling']\" ).trigger('click');\n            $( \"#sameAsBilling\" ).prop( \"disabled\", true );\n            $(\"input[name='shippingAddress.shouldSaveAddress']\").prop( \"disabled\", true );\n            $(\"input[name='shippingAddress.shouldSaveAddress']\" ).prop( \"checked\", false );\n            \n        }\n          \n                \n        }\n        \n    } else {\n        console.log('Normal Shipping');\n        /* console.log(getCookie('cartId'));\n         console.log(getCookie('consignmentsId'));\n         console.log(getCookie('shippingId'));\n         updateConsignment(`/api/storefront/checkouts/`, getCookie('cartId'), getCookie('consignmentsId'),{\n            \"shippingOptionId\": getCookie('shippingId')\n         })\n          .then(data => console.log(JSON.stringify(data)))\n          .catch(error => console.error(error));*/\n\n        fetch('/api/storefront/cart', {\n            credentials: 'include'\n        }).then(function(response) {\n            return response.json();\n        }).then(function(myJson) {\n            //console.log(myJson);\n            var a = JSON.parse(JSON.stringify(myJson));\n            var x = [];\n\n            //push cart items to array x\n            for (var i = 0; i < a[0]['lineItems']['physicalItems'].length; i++) {\n                x.push({\n                    \"itemId\": a[0]['lineItems']['physicalItems'][i]['id'],\n                    \"quantity\": a[0]['lineItems']['physicalItems'][i]['quantity']\n                });\n            }\n\n            createConsignment(`/api/storefront/checkouts/`, a[0]['id'],\n                    [{\n                        \"shippingAddress\": {\n                            \"first_name\": '',\n                            \"last_name\": '',\n                            \"address1\": '',\n                            \"city\": '',\n                            \"stateOrProvinceCode\": '',\n                            \"countryCode\": 'US',\n                            \"postalCode\": ''\n                        },\n                        \"lineItems\": x\n                    }]\n                ).then(function(data) {\n                    console.log(JSON.stringify(data));\n                })\n                .catch(error => console.error(error));\n\n        });\n        //$( \"#sameAsBilling\" ).prop( \"disabled\", true );\n        //$( \"#sameAsBilling\" ).prop( \"checked\", false );\n    }\n\n\n    function updateConsignment(url, cartId, consignmentId, data, ) {\n        return fetch(url + cartId + `/consignments/` + consignmentId, {\n                method: \"PUT\",\n                credentials: \"same-origin\",\n                headers: {\n                    \"Content-Type\": \"application/json;\",\n                },\n                body: JSON.stringify(data),\n            })\n            .then(response => response.json());\n    };\n\n    function createConsignment(url, cartId, data) {\n        return fetch(url + cartId + `/consignments?include=consignments.availableShippingOptions`, {\n                method: \"POST\",\n                credentials: \"same-origin\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                },\n                body: JSON.stringify(data),\n            })\n            .then(response => response.json());\n    };\n\n});\n\n\nwindow.setInterval(function(){\n    var ship = getCookie(\"appointment_details\");\n    var cookieShipAddress = getCookie(\"shipAddress\");\n    if (cookieShipAddress == '') {\n        if (ship) {\n            var obj = JSON.parse(ship);\n            var ismobile = obj[0].ismobile;\n            if(ismobile == 'no'){\n                $( \"#checkoutShippingAddress #firstNameInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #lastNameInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #companyInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #addressLine1Input\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #addressLine2Input\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #cityInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #countryCodeInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #provinceCodeInput\" ).prop( \"disabled\", true );\n                $( \"#checkoutShippingAddress #postCodeInput\" ).prop( \"disabled\", true );\n                \n                //$( \"#sameAsBilling\" ).prop( \"checked\", false );\n                //$( \"#sameAsBilling\" ).val(\"false\");\n                // $(\"#sameAsBilling\").removeAttr('checked');\n                if($(\"#sameAsBilling\").prop(\"checked\") == true){\n                    $(\"label[for='sameAsBilling']\" ).trigger('click');\n                    $( \"#sameAsBilling\" ).prop( \"disabled\", true );\n                }\n                $(\"input[name='shippingAddress.shouldSaveAddress']\").prop( \"disabled\", true );\n                $(\"input[name='shippingAddress.shouldSaveAddress']\" ).prop( \"checked\", false );\n            }\n        }\n    }\n}, 1000);\n\n/* Get Cookie Function */\n    function getCookie(c_name) {\n        if (document.cookie.length > 0) {\n            c_start = document.cookie.indexOf(c_name + \"=\");\n            if (c_start != -1) {\n                c_start = c_start + c_name.length + 1;\n                c_end = document.cookie.indexOf(\";\", c_start);\n                if (c_end == -1) {\n                    c_end = document.cookie.length;\n                }\n                return unescape(document.cookie.substring(c_start, c_end));\n            }\n        }\n        return \"\";\n    }\n\n    /* Set Cookie */\n    function setCookie(name, value, days) {\n        var expires = \"\";\n        if (days) {\n            var date = new Date();\n            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n            expires = \"; expires=\" + date.toUTCString();\n        }\n        document.cookie = name + \"=\" + (value || \"\") + expires + \"; path=/\";\n    }\n\n</script>\n<!-- Google Tag Manager (noscript) -->\n\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-TL2GR9N\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n \n{{/partial}}\n\n{{> layout/empty}}\n"}
